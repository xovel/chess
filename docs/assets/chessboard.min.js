!function(){"use strict";function e(e){if("string"!=typeof e)return!1;var r=e.split("-");return 2===r.length&&(!0===n(r[0])&&!0===n(r[1]))}function n(e){return"string"==typeof e&&-1!==e.search(/^[a-h][1-8]$/)}function r(e){return"string"==typeof e&&-1!==e.search(/^[bw][KQRNBP]$/)}function t(e){if("string"!=typeof e)return!1;var n=(e=e.replace(/ .+$/,"")).split("/");if(8!==n.length)return!1;for(var r=0;r<8;r++)if(""===n[r]||n[r].length>8||-1!==n[r].search(/[^kqrbnpKQRNBP1-8]/))return!1;return!0}function o(e){if("object"!=typeof e)return!1;for(var t in e)if(!0===e.hasOwnProperty(t)&&(!0!==n(t)||!0!==r(e[t])))return!1;return!0}function a(e){return e.toLowerCase()===e?"b"+e.toUpperCase():"w"+e.toUpperCase()}function i(e){var n=e.split("");return"w"===n[0]?n[1].toUpperCase():n[1].toLowerCase()}function s(e){if(!0!==t(e))return!1;for(var n=(e=e.replace(/ .+$/,"")).split("/"),r={},o=8,i=0;i<8;i++){for(var s=n[i].split(""),p=0,f=0;f<s.length;f++)-1!==s[f].search(/[1-8]/)?p+=parseInt(s[f],10):(r[c[p]+o]=a(s[f]),p++);o--}return r}function p(e){if(!0!==o(e))return!1;for(var n="",r=8,t=0;t<8;t++){for(var a=0;a<8;a++){var s=c[a]+r;!0===e.hasOwnProperty(s)?n+=i(e[s]):n+="1"}7!==t&&(n+="/"),r--}return n=n.replace(/11111111/g,"8"),n=n.replace(/1111111/g,"7"),n=n.replace(/111111/g,"6"),n=n.replace(/11111/g,"5"),n=n.replace(/1111/g,"4"),n=n.replace(/111/g,"3"),n=n.replace(/11/g,"2")}var c="abcdefgh".split("");window.ChessBoard=window.ChessBoard||function(r,a){function i(){return"xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx".replace(/x/g,function(e){return(16*Math.random()|0).toString(16)})}function f(e){return JSON.parse(JSON.stringify(e))}function u(e){var n=e.split(".");return{major:parseInt(n[0],10),minor:parseInt(n[1],10),patch:parseInt(n[2],10)}}function d(e,n){return e=u(e),n=u(n),1e4*e.major*1e4+1e4*e.minor+e.patch>=1e4*n.major*1e4+1e4*n.minor+n.patch}function h(e,n,r){if(!0===a.hasOwnProperty("showErrors")&&!1!==a.showErrors){var t="ChessBoard Error "+e+": "+n;return"console"===a.showErrors&&"object"==typeof console&&"function"==typeof console.log?(console.log(t),void(arguments.length>=2&&console.log(r))):"alert"===a.showErrors?(r&&(t+="\n\n"+JSON.stringify(r)),void window.alert(t)):void("function"==typeof a.showErrors&&a.showErrors(e,n,r))}}function l(){if("string"==typeof r){if(""===r)return window.alert("ChessBoard Error 1001: The first argument to ChessBoard() cannot be an empty string.\n\nExiting..."),!1;var e=document.getElementById(r);if(!e)return window.alert('ChessBoard Error 1002: Element with id "'+r+'" does not exist in the DOM.\n\nExiting...'),!1;ie=$(e)}else if(1!==(ie=$(r)).length)return window.alert("ChessBoard Error 1003: The first argument to ChessBoard() must be an ID or a single DOM node.\n\nExiting..."),!1;return window.JSON&&"function"==typeof JSON.stringify&&"function"==typeof JSON.parse?(window.$,!(!$.fn||!$.fn.jquery||!0!==d($.fn.jquery,ge))||(window.alert("ChessBoard Error 1005: Unable to find a valid version of jQuery. Please include jQuery "+ge+" or higher on the page.\n\nExiting..."),!1)):(window.alert("ChessBoard Error 1004: JSON does not exist. Please include a JSON polyfill.\n\nExiting..."),!1)}function v(e){return"fast"===e||"slow"===e||parseInt(e,10)+""==e+""&&e>=0}function g(){return"string"!=typeof a&&!0!==o(a)||(a={position:a}),"black"!==a.orientation&&(a.orientation="white"),Oe=a.orientation,!1!==a.showNotation&&(a.showNotation=!0),!0!==a.draggable&&(a.draggable=!1),"trash"!==a.dropOffBoard&&(a.dropOffBoard="snapback"),!0!==a.sparePieces&&(a.sparePieces=!1),!0===a.sparePieces&&(a.draggable=!0),(!0!==a.hasOwnProperty("pieceTheme")||"string"!=typeof a.pieceTheme&&"function"!=typeof a.pieceTheme)&&(a.pieceTheme="./assets/img/{piece}.png"),!0===a.hasOwnProperty("appearSpeed")&&!0===v(a.appearSpeed)||(a.appearSpeed=200),!0===a.hasOwnProperty("moveSpeed")&&!0===v(a.moveSpeed)||(a.moveSpeed=200),!0===a.hasOwnProperty("snapbackSpeed")&&!0===v(a.snapbackSpeed)||(a.snapbackSpeed=50),!0===a.hasOwnProperty("snapSpeed")&&!0===v(a.snapSpeed)||(a.snapSpeed=25),!0===a.hasOwnProperty("trashSpeed")&&!0===v(a.trashSpeed)||(a.trashSpeed=100),!0===a.hasOwnProperty("position")&&("start"===a.position?xe=f(we):!0===t(a.position)?xe=s(a.position):!0===o(a.position)?xe=f(a.position):h(7263,"Invalid value passed to config.position.",a.position)),!0}function w(){var e=parseInt(ie.css("width"),10);if(!e||e<=0)return 0;for(var n=e-1;n%8!=0&&n>0;)n--;return n/8}function y(){for(t=0;t<c.length;t++)for(var e=1;e<=8;e++){var n=c[t]+e;Ee[n]=n+"-"+i()}for(var r="KQRBNP".split(""),t=0;t<r.length;t++){var o="w"+r[t],a="b"+r[t];$e[o]=o+"-"+i(),$e[a]=a+"-"+i()}}function m(){var e='<div class="'+ye.chessboard+'">';return!0===a.sparePieces&&(e+='<div class="'+ye.sparePieces+" "+ye.sparePiecesTop+'"></div>'),e+='<div class="'+ye.board+'"></div>',!0===a.sparePieces&&(e+='<div class="'+ye.sparePieces+" "+ye.sparePiecesBottom+'"></div>'),e+="</div>"}function b(e){"black"!==e&&(e="white");var n="",r=f(c),t=8;"black"===e&&(r.reverse(),t=1);for(var o="white",i=0;i<8;i++){n+='<div class="'+ye.row+'">';for(var s=0;s<8;s++){var p=r[s]+t;n+='<div class="'+ye.square+" "+ye[o]+" square-"+p+'" style="width: '+ue+"px; height: "+ue+'px" id="'+Ee[p]+'" data-square="'+p+'">',!0===a.showNotation&&(("white"===e&&1===t||"black"===e&&8===t)&&(n+='<div class="'+ye.notation+" "+ye.alpha+'">'+r[s]+"</div>"),0===s&&(n+='<div class="'+ye.notation+" "+ye.numeric+'">'+t+"</div>")),n+="</div>",o="white"===o?"black":"white"}n+='<div class="'+ye.clearfix+'"></div></div>',o="white"===o?"black":"white","white"===e?t--:t++}return n}function P(e){return"function"==typeof a.pieceTheme?a.pieceTheme(e):"string"==typeof a.pieceTheme?a.pieceTheme.replace(/{piece}/g,e):(h(8272,"Unable to build image source for cfg.pieceTheme."),"")}function O(e,n,r){var t='<img src="'+P(e)+'" ';return r&&"string"==typeof r&&(t+='id="'+r+'" '),t+='alt="" class="'+ye.piece+'" data-piece="'+e+'" style="width: '+ue+"px;height: "+ue+"px;",!0===n&&(t+="display:none;"),t+='" />'}function x(e){var n=["wK","wQ","wR","wB","wN","wP"];"black"===e&&(n=["bK","bQ","bR","bB","bN","bP"]);for(var r="",t=0;t<n.length;t++)r+=O(n[t],!1,$e[n[t]]);return r}function S(e,n,r,t){var o=$("#"+Ee[e]),s=o.offset(),p=$("#"+Ee[n]),c=p.offset(),f=i();$("body").append(O(r,!0,f));var u=$("#"+f);u.css({display:"",position:"absolute",top:s.top,left:s.left}),o.find("."+ye.piece).remove();var d={duration:a.moveSpeed,complete:function(){p.append(O(r)),u.remove(),"function"==typeof t&&t()}};u.animate(c,d)}function E(e,n,r){var t=$("#"+$e[e]).offset(),o=$("#"+Ee[n]),s=o.offset(),p=i();$("body").append(O(e,!0,p));var c=$("#"+p);c.css({display:"",position:"absolute",left:t.left,top:t.top});var f={duration:a.moveSpeed,complete:function(){o.find("."+ye.piece).remove(),o.append(O(e)),c.remove(),"function"==typeof r&&r()}};c.animate(s,f)}function q(e,n,r){function t(){++o===e.length&&(N(),be=!1,!0===a.hasOwnProperty("onMoveEnd")&&"function"==typeof a.onMoveEnd&&a.onMoveEnd(f(n),f(r)))}be=!0;for(var o=0,i=0;i<e.length;i++)"clear"===e[i].type&&$("#"+Ee[e[i].square]+" ."+ye.piece).fadeOut(a.trashSpeed,t),"add"===e[i].type&&!0!==a.sparePieces&&$("#"+Ee[e[i].square]).append(O(e[i].piece,!0)).find("."+ye.piece).fadeIn(a.appearSpeed,t),"add"===e[i].type&&!0===a.sparePieces&&E(e[i].piece,e[i].square,t),"move"===e[i].type&&S(e[i].source,e[i].destination,e[i].piece,t)}function k(e,n){e=e.split("");var r=c.indexOf(e[0])+1,t=parseInt(e[1],10);n=n.split("");var o=c.indexOf(n[0])+1,a=parseInt(n[1],10),i=Math.abs(r-o),s=Math.abs(t-a);return i>=s?i:s}function B(e){for(var n=[],r=0;r<8;r++)for(var t=0;t<8;t++){var o=c[r]+(t+1);e!==o&&n.push({square:o,distance:k(e,o)})}n.sort(function(e,n){return e.distance-n.distance});for(var a=[],r=0;r<n.length;r++)a.push(n[r].square);return a}function C(e,n,r){for(var t=B(r),o=0;o<t.length;o++){var a=t[o];if(!0===e.hasOwnProperty(a)&&e[a]===n)return a}return!1}function T(e,n){e=f(e),n=f(n);var r=[],t={};for(var o in n)!0===n.hasOwnProperty(o)&&!0===e.hasOwnProperty(o)&&e[o]===n[o]&&(delete e[o],delete n[o]);for(var o in n)if(!0===n.hasOwnProperty(o)){var a=C(e,n[o],o);!1!==a&&(r.push({type:"move",source:a,destination:o,piece:n[o]}),delete e[a],delete n[o],t[o]=!0)}for(var o in n)!0===n.hasOwnProperty(o)&&(r.push({type:"add",square:o,piece:n[o]}),delete n[o]);for(var o in e)!0===e.hasOwnProperty(o)&&!0!==t.hasOwnProperty(o)&&(r.push({type:"clear",square:o,piece:e[o]}),delete e[o]);return r}function N(){se.find("."+ye.piece).remove();for(var e in xe)!0===xe.hasOwnProperty(e)&&$("#"+Ee[e]).append(O(xe[e]))}function I(){se.html(b(Oe)),N(),!0===a.sparePieces&&("white"===Oe?(ce.html(x("black")),fe.html(x("white"))):(ce.html(x("white")),fe.html(x("black"))))}function M(e,n){e=f(e);for(var r in n)if(!0===n.hasOwnProperty(r)&&!0===e.hasOwnProperty(r)){var t=e[r];delete e[r],e[n[r]]=t}return e}function D(e){var n=f(xe),r=f(e);p(n)!==p(r)&&(!0===a.hasOwnProperty("onChange")&&"function"==typeof a.onChange&&a.onChange(n,r),xe=e)}function j(e,n){for(var r in ve)if(!0===ve.hasOwnProperty(r)){var t=ve[r];if(e>=t.left&&e<t.left+ue&&n>=t.top&&n<t.top+ue)return r}return"offboard"}function J(){ve={};for(var e in Ee)!0===Ee.hasOwnProperty(e)&&(ve[e]=$("#"+Ee[e]).offset())}function Q(){se.find("."+ye.square).removeClass(ye.highlight1+" "+ye.highlight2)}function X(){if("spare"!==le){Q();var e=$("#"+Ee[le]).offset(),n={duration:a.snapbackSpeed,complete:function(){N(),pe.css("display","none"),!0===a.hasOwnProperty("onSnapbackEnd")&&"function"==typeof a.onSnapbackEnd&&a.onSnapbackEnd(de,le,f(xe),Oe)}};pe.animate(e,n),Se=!1}else Y()}function Y(){Q();var e=f(xe);delete e[le],D(e),N(),pe.fadeOut(a.trashSpeed),Se=!1}function R(e){Q();var n=f(xe);delete n[le],n[e]=de,D(n);var r=$("#"+Ee[e]).offset(),t={duration:a.snapSpeed,complete:function(){N(),pe.css("display","none"),!0===a.hasOwnProperty("onSnapEnd")&&"function"==typeof a.onSnapEnd&&a.onSnapEnd(le,e,de)}};pe.animate(r,t),Se=!1}function K(e,n,r,t){"function"==typeof a.onDragStart&&!1===a.onDragStart(e,n,f(xe),Oe)||(Se=!0,de=n,le=e,he="spare"===e?"offboard":e,J(),pe.attr("src",P(n)).css({display:"",position:"absolute",left:r-ue/2,top:t-ue/2}),"spare"!==e&&$("#"+Ee[e]).addClass(ye.highlight1).find("."+ye.piece).css("display","none"))}function L(e,r){pe.css({left:e-ue/2,top:r-ue/2});var t=j(e,r);t!==he&&(!0===n(he)&&$("#"+Ee[he]).removeClass(ye.highlight2),!0===n(t)&&$("#"+Ee[t]).addClass(ye.highlight2),"function"==typeof a.onDragMove&&a.onDragMove(t,he,le,de,f(xe),Oe),he=t)}function U(e){var r="drop";if("offboard"===e&&"snapback"===a.dropOffBoard&&(r="snapback"),"offboard"===e&&"trash"===a.dropOffBoard&&(r="trash"),!0===a.hasOwnProperty("onDrop")&&"function"==typeof a.onDrop){var t=f(xe);"spare"===le&&!0===n(e)&&(t[e]=de),!0===n(le)&&"offboard"===e&&delete t[le],!0===n(le)&&!0===n(e)&&(delete t[le],t[e]=de);var o=f(xe),i=a.onDrop(le,e,de,t,o,Oe);"snapback"!==i&&"trash"!==i||(r=i)}"snapback"===r?X():"trash"===r?Y():"drop"===r&&R(e)}function z(){return"ontouchstart"in document.documentElement}function A(){return navigator&&navigator.userAgent&&-1!==navigator.userAgent.search(/MSIE/)}function F(e){e.preventDefault()}function W(e){if(!0===a.draggable){var r=$(this).attr("data-square");!0===n(r)&&!0===xe.hasOwnProperty(r)&&K(r,xe[r],e.pageX,e.pageY)}}function G(e){if(!0===a.draggable){var r=$(this).attr("data-square");!0===n(r)&&!0===xe.hasOwnProperty(r)&&(e.preventDefault(),e=e.originalEvent,K(r,xe[r],e.changedTouches[0].pageX,e.changedTouches[0].pageY))}}function H(e){!0===a.sparePieces&&K("spare",$(this).attr("data-piece"),e.pageX,e.pageY)}function V(e){!0===a.sparePieces&&K("spare",$(this).attr("data-piece"),(e=e.originalEvent).changedTouches[0].pageX,e.changedTouches[0].pageY)}function Z(e){!0===Se&&L(e.pageX,e.pageY)}function _(e){!0===Se&&(e.preventDefault(),L(e.originalEvent.changedTouches[0].pageX,e.originalEvent.changedTouches[0].pageY))}function ee(e){!0===Se&&U(j(e.pageX,e.pageY))}function ne(e){!0===Se&&U(j(e.originalEvent.changedTouches[0].pageX,e.originalEvent.changedTouches[0].pageY))}function re(e){if(!1===Se&&!0===a.hasOwnProperty("onMouseoverSquare")&&"function"==typeof a.onMouseoverSquare){var r=$(e.currentTarget).attr("data-square");if(!0===n(r)){var t=!1;!0===xe.hasOwnProperty(r)&&(t=xe[r]),a.onMouseoverSquare(r,t,f(xe),Oe)}}}function te(e){if(!1===Se&&!0===a.hasOwnProperty("onMouseoutSquare")&&"function"==typeof a.onMouseoutSquare){var r=$(e.currentTarget).attr("data-square");if(!0===n(r)){var t=!1;!0===xe.hasOwnProperty(r)&&(t=xe[r]),a.onMouseoutSquare(r,t,f(xe),Oe)}}}function oe(){$("body").on("mousedown mousemove","."+ye.piece,F),se.on("mousedown","."+ye.square,W),ie.on("mousedown","."+ye.sparePieces+" ."+ye.piece,H),se.on("mouseenter","."+ye.square,re),se.on("mouseleave","."+ye.square,te),!0===A()?(document.ondragstart=function(){return!1},$("body").on("mousemove",Z),$("body").on("mouseup",ee)):($(window).on("mousemove",Z),$(window).on("mouseup",ee)),!0===z()&&(se.on("touchstart","."+ye.square,G),ie.on("touchstart","."+ye.sparePieces+" ."+ye.piece,V),$(window).on("touchmove",_),$(window).on("touchend",ne))}function ae(){ie.html(m()),se=ie.find("."+ye.board),!0===a.sparePieces&&(ce=ie.find("."+ye.sparePiecesTop),fe=ie.find("."+ye.sparePiecesBottom));var e=i();$("body").append(O("wP",!0,e)),pe=$("#"+e),Pe=parseInt(se.css("borderLeftWidth"),10),me.resize()}a=a||{};var ie,se,pe,ce,fe,ue,de,he,le,ve,ge="1.7.0",we=s("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR"),ye={alpha:"alpha-d2270",black:"black-3c85d",board:"board-b72b1",chessboard:"chessboard-63f37",clearfix:"clearfix-7da63",highlight1:"highlight1-32417",highlight2:"highlight2-9c5d2",notation:"notation-322f9",numeric:"numeric-fc462",piece:"piece-417db",row:"row-5277c",sparePieces:"spare-pieces-7492f",sparePiecesBottom:"spare-pieces-bottom-ae20f",sparePiecesTop:"spare-pieces-top-4028b",square:"square-55d63",white:"white-1e1d7"},me={},be=!1,Pe=2,Oe="white",xe={},Se=!1,$e={},Ee={};return me.clear=function(e){me.position({},e)},me.destroy=function(){ie.html(""),pe.remove(),ie.unbind()},me.fen=function(){return me.position("fen")},me.flip=function(){me.orientation("flip")},me.move=function(){if(0!==arguments.length){for(var n=!0,r={},t=0;t<arguments.length;t++)if(!1!==arguments[t])if(!0===e(arguments[t])){var o=arguments[t].split("-");r[o[0]]=o[1]}else h(2826,"Invalid move passed to the move method.",arguments[t]);else n=!1;var a=M(xe,r);return me.position(a,n),a}},me.orientation=function(e){return 0===arguments.length?Oe:"white"===e||"black"===e?(Oe=e,void I()):"flip"===e?(Oe="white"===Oe?"black":"white",void I()):void h(5482,"Invalid value passed to the orientation method.",e)},me.position=function(e,n){return 0===arguments.length?f(xe):"string"==typeof e&&"fen"===e.toLowerCase()?p(xe):(!1!==n&&(n=!0),"string"==typeof e&&"start"===e.toLowerCase()&&(e=f(we)),!0===t(e)&&(e=s(e)),void(!0===o(e)?!0===n?(q(T(xe,e),xe,e),D(e)):(D(e),N()):h(6482,"Invalid value passed to the position method.",e)))},me.resize=function(){ue=w(),se.css("width",8*ue+"px"),pe.css({height:ue,width:ue}),!0===a.sparePieces&&ie.find("."+ye.sparePieces).css("paddingLeft",ue+Pe+"px"),I()},me.start=function(e){me.position("start",e)},!0===l()&&!0===g()&&(y(),ae(),oe()),me},window.ChessBoard.fenToObj=s,window.ChessBoard.objToFen=p}();
